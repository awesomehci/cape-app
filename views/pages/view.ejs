<!DOCTYPE html>
<html>
<head>
    <% include ../partials/header.ejs %>
</head>

<!-- TODO: change format to 3 column-->
<body>
<script>
    var paperTitle = "";
    var paperOwner ="";
    var paperURL = "";
    var preferences;
    var meeds;

    var xhr = new XMLHttpRequest();
    var url = "/api/papers/58b8aec99234103984e0f8d1";
    xhr.open("GET", url, true);

    //Send the proper header information along with the request
    xhr.setRequestHeader("Content-type", "application/json");
    xhr.setRequestHeader("Accept", "application/json");

    xhr.onreadystatechange = function() {//Call a function when the state changes.

        if(xhr.readyState == 4 && xhr.status == 200) {
            var response = JSON.parse(xhr.responseText);

            paperTitle = response.title;
            paperOwner = response.owner;
            paperURL = "http://docs.google.com/gview?url=" + response.url + "&embedded=true";
            preferences = response.preferences;
            console.log(preferences);

            document.getElementById('paperTitle').innerHTML = "Title: " + paperTitle;
            document.getElementById('paperOwner').innerHTML = "Owner: " + paperOwner;
            document.getElementById('paperIframe').src = paperURL ;
            document.getElementById('preferencelist').appendChild(makeUL(preferences));
            //console.log(paperURL);

        }
    }

    function makeUL(array) {
        // Create the list element:
        var list = document.createElement('ul');

        for(var i = 0; i < array.length; i++) {
            // Create the list item:
            var item = document.createElement('li');
            // Set its contents:
            item.appendChild(document.createTextNode(array[i]));
            // Add it to the list:
            list.appendChild(item);
        }
        // Finally, return the constructed list:
        return list;
    }


    window.onload=function()
    {
        xhr.send();
    }

</script>



<div class="col-md-6"> <!--splits the page in half-->
    <div class="container">
        <h1>View Paper Status</h1>
        <h2><span id="paperTitle"></span></h2>
        <h3><span id="paperOwner"></span></h3>
    </div>


    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <h3>Preferences</h3>
                <div id="preferencelist"></div>
            </div>
            <div class="col-md-6">
                <h3>Proofreading Needs</h3>
                <ul>
                    <li>
                        I need help with grammar
                    </li>
                </ul>
            </div>
        </div>

        <div>
            <h3>Proofreaders</h3>
            <div class="row">
                <div class="col-md-3">
                    <ul class="list-unstyled">
                        <li><i class="material-icons" style="vertical-align: top; font-size:18px">check_box_outline_blank</i>Jane Doe</li>
                        <li><i class="material-icons" style="vertical-align: top; font-size:18px">check_box</i>John Smith</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <ul class="list-unstyled">
                        <li><i class="material-icons" style="vertical-align: top; align: left; font-size:18px">file_upload</i></span></li>
                        <li><a href="">FileName.docx</a></li>
                    </ul>
                </div>
            </div>


            <div>
                <a type="button" class="btn btn-primary" href="https://github.com/heroku/node-js-getting-started">Go to
                    Account</a>
            </div>
        </div>
    </div>
</div>


<div class="col-md-6"> <!--splits the page in half-->
    <div class="container">
        <span class="glyphicon glyphicon-save"></span>
    </div>

    <!--Obviously needs to show actual paper -->
    <iframe id="paperIframe" style="width: 100%; height:500px;"></iframe>
</div>

</body>
</html>
